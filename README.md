# Mathematical Perspectives on Transformers: Replications and Explorations

This repository contains code and notebooks dedicated to exploring and replicating concepts from the research paper **"A mathematical perspective on Transformers"** by Borjan Geshkovski, Cyril Letrouit, Yury Polyanskiy, and Philippe Rigollet. It also includes related explorations into transformer architectures and their underlying mathematical principles.

## Core Goal

The primary objective of this project is to understand and replicate key findings and figures presented in the aforementioned paper. This involves implementing and experimenting with transformer models, analyzing their behavior through visualizations, and exploring related mathematical concepts such as rotations on a sphere and particle system interactions.

1. Clustering
2. Phase change from metastable clusters to ...

## Repository Structure

```
trafo_seminar/
├── GESHKOVSKI - a mathematical perspective on transformers.pdf 
├── notebooks/
│   ├── test.ipynb              # xxx
│   └── test.ipynb              # xxx
│
├── trafo-rotf-main/            # code from original authors
├── mini_gpt/                   # andrej kaparthy
├── plots/                      # plot outputs
├── .gitignore
└── README.md
```

## Key Files and Experiments

*   **Paper Replication:** The primary notebooks for replicating Figure 1 of the Geshkovski et al. paper are `2025_05_28 rep_fig1_v2.ipynb` and `2025_04_29 rep_fig1.ipynb`. These notebooks likely load data, configure Albert-like models, and generate visualizations of attention mechanisms or particle interactions.
*   **Self-Attention as Particle Systems:** `2025_04_29 1st SA particle system.ipynb` explores the concept of self-attention mechanisms behaving like interacting particle systems.
*   **Hypersphere Visualization:** `2025_05_19 3d hypersphere.ipynb` is dedicated to visualizing and calculating properties of 3D hyperspheres, which may relate to the geometric interpretations of transformer embeddings.
*   **`trafo-rotf-main/` Directory:** This directory contains example code provided by the authors of the Geshkovski et al. paper. It includes Python scripts and notebooks for:
    *   Generating phase diagrams (`phase-diagrams_own.py`, `phase-diagrams.py`).
    *   Analyzing curves (`curve.ipynb`).
    *   Experimenting with ALBERT models (`albert_own.py`, `albert.ipynb`).
    *   Working with spherical projections (`sphere.py`).
    *   It also includes fascinating animations in the `movies/` subdirectory.
*   **`mini_gpt/` Directory:** This section focuses on building and understanding a smaller version of a GPT model from scratch, including bigram models (`bigram.py`, `bigram v2.py`) and a more complete GPT implementation (`gpt.py`).
*   **`plots/` Directory:** This directory stores various visualizations generated by the notebooks, including the `3d sphere.png` and timestamped directories containing plots from different experimental runs (e.g., varying the number of hidden layers `hl`).

## How to Use / Prerequisites

1.  **Clone the repository:**
    ```bash
    git clone <repository-url>
    cd <repository-name>
    ```
2.  **Environment Setup:** It's recommended to use a virtual environment (e.g., conda or venv).
    ```bash
    python -m venv .venv
    source .venv/bin/activate  # On Windows use `.venv\Scripts\activate`
    ```
3.  **Install Dependencies:** The notebooks and scripts primarily use the following libraries. You can install them using pip:
    ```bash
    pip install torch numpy seaborn matplotlib jupyterlab pandas transformers datasets
    ```
    *(Note: Check individual notebooks for any other specific imports.)*
4.  **Run Jupyter Notebooks:**
    ```bash
    jupyter lab
    ```
    Then navigate to and open the desired `.ipynb` file.

## Paper Reference

The work in this repository is largely based on and aims to replicate findings from:

*   Geshkovski, B., Letrouit, C., Polyanskiy, Y., & Rigollet, P. (2023). *A mathematical perspective on Transformers*. arXiv preprint arXiv:2312.10794.
    *   **arXiv Link:** [https://arxiv.org/abs/2312.10794](https://arxiv.org/abs/2312.10794)
    *   **Authors' Code:** The `trafo-rotf-main/` directory contains example code from the authors, which can also be found on [GitHub](https://github.com/borjanG/2023-transformers-rotf) (if this is the correct link, otherwise adjust).
    *   **BibTeX:**
        ```bibtex
        @article{geshkovski2023perspective,
              title={A mathematical perspective on Transformers},
              author={Borjan Geshkovski and Cyril Letrouit and Yury Polyanskiy and Philippe Rigollet},
              year={2023},
              eprint={2312.10794},
              archivePrefix={arXiv},
              primaryClass={cs.LG}
        }
        ```

The `trafo-rotf-main` subdirectory appears to contain code directly from or inspired by the authors of this paper.

## Visualizations

Key visualizations, including plots from Figure 1 replications, 3D sphere plots, and animations from the `trafo-rotf-main/movies` directory, are available within the `plots/` and `trafo-rotf-main/movies/` folders.

---

This README provides a general overview. For more specific details, please refer to the individual notebooks and the `README.md` within the `trafo-rotf-main/` subdirectory.
